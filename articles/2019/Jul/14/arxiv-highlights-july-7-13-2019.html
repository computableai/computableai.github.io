<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <!--<![endif]-->
    <head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Computable AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Computable AI is a machine intelligence blog from a handful of DRL practitioners, intended to crystalize, internalize, share, and explain.">
  <link rel="shortcut icon" href="https://computable.ai/favicon.ico" type="image/x-icon">
  <meta name="author" content="the Computable AI authors">
  <meta name="copyright" content="the Computable AI authors">
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@computableai" />
  <meta property="og:site_name" content="Computable AI" />

  <meta property="og:title" content="Computable AI" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://computable.ai" />
  <meta name="twitter:url" content="https://computable.ai" />
  <meta itemprop="name" content="Computable AI" />
  <meta itemprop="url" content="https://computable.ai"/>
  <meta property="og:description" content="Computable AI is a machine intelligence blog from a handful of DRL practitioners, intended to crystalize, internalize, share, and explain." />
  <meta name="twitter:description" content="Computable AI is a machine intelligence blog from a handful of DRL practitioners, intended to crystalize, internalize, share, and explain." />
  <meta itemprop="description" content="Computable AI is a machine intelligence blog from a handful of DRL practitioners, intended to crystalize, internalize, share, and explain." />
  <link href="https://computable.ai/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Computable AI ATOM Feed"/>
  <link href='//fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/uikit.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/components/search.min.css">
  <link rel="stylesheet" href="https://computable.ai/theme/css/tipuesearch.css">
  <link rel="stylesheet" href="https://computable.ai/theme/css/solarized.css">
  <link rel="stylesheet" href="https://computable.ai/theme/css/main.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    </head>
    <body>
<!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]--><header class="site-header">

    <div class="uk-container uk-container-center">

        <a class="mg-brand uk-navbar-brand uk-hidden-small" href="https://computable.ai">
          <img src="https://computable.ai/theme/images/logo-disc.png" height=50 width=50 />
Computable AI        </a>

        <p class="mg-tagline uk-hidden-small">A Machine Intelligence Blog</p>

        <a class="offcanvas-nav-toggle uk-visible-small" href="#mg-offcanvas" data-uk-offcanvas></a>

        <a class="mg-brand uk-navbar-brand uk-navbar-center uk-visible-small" href="https://computable.ai">
          <img src="https://computable.ai/theme/images/logo-disc.png" height=50 width=50 />
Computable AI        </a>

    </div>

</header>        <main class="mg-main">
            <div class="uk-container uk-container-center">
                <div class="uk-grid" data-uk-grid-margin>

<div class="uk-width-medium-7-10 content-article">

    <article class="">
      <header class="article-header">
        <h1 class="uk-heading-large uk-article-title" itemprop="name">arXiv highlights July 7-13 2019</h1>
        <p class="uk-article-lead" itemprop="description">Way Off-Policy Batch DRL using a generative model of pre-recorded trajectories, and bias correction.</p>
        <p class="uk-article-meta">
<span class="uk-author">Daniel Cox</span> •           <time datetime="2019-07-14" itemprop="datePublished">Sun 14 July 2019</time> in <a href="https://computable.ai/category/arxiv-highlights.html">arXiv highlights</a> • <br class="uk-visible-small"> <a href="https://computable.ai/articles/2019/Jul/14/arxiv-highlights-july-7-13-2019.html#disqus_thread" itemprop="discussionUrl"></a></p>
<!-- <a class="collab-link" href="https://colab.research.google.com/github/computableai/computableai.github.io/blob/dev/computableai/content/arXiv highlights July 7-13 2019.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Colab" title="Open in Google Colaboratory"></a> -->

<a class="collab-link" href="https://colab.research.google.com/github/computableai/computableai.github.io/blob/dev/content/arXiv highlights July 7-13 2019.ipynb">
  Open in Colab
  
  <svg width="26px" height="26px" viewBox="0 0 26 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
        <g id="arrow-up-right" transform="translate(-19, -19)" fill-rule="nonzero" stroke="#007AFF" stroke-width="2">
            <path d="M20,44 L44,20 L20,44 Z M24,20 L44,20 L44,40" id="border"></path>
        </g>
    </g>
  </svg>
</a>      </header>

      <div class="article-body">
        <section itemprop="articleBody">
          
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="This-week">This week<a class="anchor-link" href="#This-week">&#182;</a></h1><p>Only one paper this week, <em>not</em> because <a href="https://arxiv.org/abs/1905.04819">others</a> failed to catch my eye, but for brevity. Let me know in the comments if you agree that shorter or more focused articles are more attractive. So this week I'll be examining just one paper: <a href="https://arxiv.org/abs/1907.00456">Way Off-Policy Batch Deep Reinforcement Learning of Implicit Human Preferences in Dialog</a>. As with last week's papers, this week's is interesting to me professionally. Batch DRL is a way to solve the sample efficiency problem, from a certain perspective. It's mostly the online learning that costs too much when sample efficiency is low, so solving the problems that come with attempting to train offline might allow us to do many of the same things we could do if we had high online sample efficiency.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="RL-for-open-domain-dialog-generation">RL for open-domain dialog generation<a class="anchor-link" href="#RL-for-open-domain-dialog-generation">&#182;</a></h1><p>The author's domain is dialog generation. They want to build a better chat bot, and they have quite a few recorded conversations. RL is good at refining these processes, but has a cold-start problem, plus they would certainly prefer to make use of the data they have on-hand. For this, they need to be able to make use of offline data, hence "<em>Way</em> Off-Policy". This data is so off-policy it wasn't even <em>generated</em> by a policy.</p>
<p>So they want to train DRL from samples acquired from some other control of the system (in their case, human interaction data), much like <a href="https://arxiv.org/abs/1704.03732">Deep Q-learning from Demonstrations</a>. There are a couple of reasons this is important for others such as myself:</p>
<blockquote><p>First, since collecting real-world interaction data can be expensive and time-consuming, algorithms must be able to leverage off-policy data - collected from vastly different systems, far into the past - in order to learn.</p>
<p>Second, it is often necessary to carefully test a policy before deploying it to the real world; for example, to ensure its behavior is safe and appropriate for humans. Thus the algorithm must be able to learn offline first, from a static batch of data, without the ability to explore</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-generative-model-+-Q-learning">A generative model + Q learning<a class="anchor-link" href="#A-generative-model-+-Q-learning">&#182;</a></h1><p>The authors first pre-train a generative model on the distribution of collected trajectories, and initialize the Q networks from this model. They then sample a fixed number of actions from it, and output the one with the highest Q-value as their policy's decision. In later reinforcement learning, they penalize their model for KL-divergence from this distribution.</p>
<blockquote><p>To perform batch Q-learning, we first pre-train a generative model of $p(a|s)$ using a set of known environment trajectories. In our case, this model is then used to generate the batch data via human interaction. The weights of the Q-network and target Q-network are initialized from the pre-trained model, which helps reduce variance in the Q-estimates and works to combat overestimation bias. To train $Q_{θ_π}$ we sample &lt; $s_t$, $a_t$, $r_t$, $s_{t+1}$ &gt; tuples from the batch, and update the weights of the Q-network to approximate Eq. 1. This forms our baseline model, which we call Batch Q</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Overestimation-bias">Overestimation bias<a class="anchor-link" href="#Overestimation-bias">&#182;</a></h1><blockquote><p>Most deep RL algorithms fail to learn from data that is not heavily correlated with the current policy. Even models based on off-policy algorithms lik Q-learning fail to learn when the model is not able to explore during training. This is due to the fact that such algorithms are inherently optimistic in the face of uncertainty.</p>
</blockquote>
<p>If you’re taking the <code>max</code> of something (as in Bellman-equation-based algorithms), then the higher the variance, the higher the <code>max</code> value. This causes an over-estimation bias. We may have seen a really high value for some state once, so now we over-value that state, despite it being atypical. It may not be immediately obvious why this is a <em>problem</em>, but which states are we likely to overvalue? Precisely the states we haven't visited often. Why is <em>that</em> a problem? This sounds good for exploration, right? But if we're trying to train our agent with canned data, it's important that the live agent stick pretty close to the states where the canned data does well, and it's counter-productive to have it believe that everywhere <em>but</em> the pre-explored state space is worth exploring.</p>
<p>A popular solution to the overestimation problem in Q-learning algorithms is to train <em>two</em> Q networks on the same data, put the input through both, and take the minimum value. This helps with the bias because they'll likely disagree unless we can be really <em>certain</em> of the value of the input, and if they disagree we can go with the least confident. The authors of the current paper take a different tack, training a single neural net with dropout, and using the disagreement with different dropout masks as an estimate of uncertainty.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Parting-thoughts">Parting thoughts<a class="anchor-link" href="#Parting-thoughts">&#182;</a></h1><ol>
<li><p>I didn't talk much about their model architecture, which is "Variational Hierarchical Recurrent Encoder Decoder (VHRED)", largely because I think if I ever tried to make use of this directly I would employ transformers instead. They do mention that transformer architectures are a "powerful alternative", but they chose to work with hierarchical architectures so they could extend their work to hierarchical control in the future. That's interesting. In my own work at the moment, the important thing is the "way off-policy" part, not so much the chat bot part.</p>
</li>
<li><p>It's very interesting to me that both of the methods for correcting overestimation bias make use of uncertainty estimators that I've seen mentioned elsewhere:</p>
<ul>
<li><a href="https://arxiv.org/abs/1905.09638">Estimating Risk and Uncertainty in Deep Reinforcement Learning</a></li>
</ul>
<blockquote><p>...we show that the disagreement between only two neural networks is sufficient to produce a low-variance estimate of the epistemic uncertainty on the return distribution, thus providing a simple and computationally cheap uncertainty metric.</p>
</blockquote>
<ul>
<li><a href="https://arxiv.org/abs/1506.02142">Dropout as a Bayesian Approximation: Representing Model Uncertainty in Deep Learning</a></li>
</ul>
<blockquote><p>...we develop a new theoretical framework casting dropout training in deep neural networks (NNs) as approximate Bayesian inference in deep Gaussian processes. A direct result of this theory gives us tools to model uncertainty with dropout NNs</p>
</blockquote>
</li>
<li><p>This article wasn't really shorter than if I had done multiple papers, less deeply. I'll have to practice at that, not least because it's time-consuming, but information is valuable. How does Adrian Colyer do this every <em>day</em>?</p>
</li>
</ol>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

        </section>
      </div>
    </article>

    <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'computableai'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>
<div class="uk-width-medium-3-10 uk-width-large-2-10 uk-hidden-small site-sidebar">

    <!--     <div class="uk-panel">
        <form class="uk-search" action="/search.html" data-uk-search>
            <input class="uk-search-field tipue_search" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
        </form>
    </div>
 -->

    <nav class="site-navigation">
        <ul>
            <h2>Categories</h2>
                <li>
                    <a class="active" href="https://computable.ai/category/arxiv-highlights.html">arXiv highlights</a>
                    <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/arxiv-highlights.atom.xml" class="feed-link"><i class="uk-icon-rss uk-icon-tiny"></i></a>
                </li>
                <li>
                    <a  href="https://computable.ai/category/math.html">Math</a>
                    <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/math.atom.xml" class="feed-link"><i class="uk-icon-rss uk-icon-tiny"></i></a>
                </li>
                <li>
                    <a  href="https://computable.ai/category/miscellany.html">Miscellany</a>
                    <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/miscellany.atom.xml" class="feed-link"><i class="uk-icon-rss uk-icon-tiny"></i></a>
                </li>
            <hr />
                <!-- <h2>Pages</h2> -->
                <li>
                    <a  href="https://computable.ai/pages/about.html">About</a>
                </li>

            <!-- <li><a  href="https://computable.ai/archives.html">Archives</a></li> -->
        </ul>
        <hr />
    </nav>

    <aside class="extras">
        <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/all.atom.xml"><i class="uk-icon-rss uk-icon-medium"></i></a>
        <a class="mg-icon-link" href="https://twitter.com/computableai">
            <i class="uk-icon-twitter uk-icon-medium"></i>
        </a>
        <a class="mg-icon-link" href="https://github.com/computableai">
            <i class="uk-icon-github uk-icon-medium"></i>
        </a>
    </aside>

</div>                </div>
            </div>
        </main>

<footer class="site-footer">
    <p>Copyright © 2019 the Computable AI authors. All rights reserved.</p>
    <p>Powered by <a href="http://blog.getpelican.com">Pelican</a>.<br class="uk-visible-small"> Theme based on <a href="https://github.com/lucachr/pelican-mg">mg</a>.</p>
</footer>

<div id="mg-offcanvas" class="uk-offcanvas">
  <div class="uk-offcanvas-bar">

      <form class="uk-search" action="search.html" data-uk-search>
          <input class="uk-search-field" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
      </form>

      <ul class="offcanvas-nav" data-uk-nav>
          <h2 class="">Categories</h2>
          <li class="uk-active">
            <a href="https://computable.ai/category/arxiv-highlights.html">arXiv highlights</a>
            <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/arxiv-highlights.atom.xml" class="mg-feed" style="float:right"><i class="uk-icon-rss uk-icon-tiny"></i></a>
          </li>
          <li >
            <a href="https://computable.ai/category/math.html">Math</a>
            <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/math.atom.xml" class="mg-feed" style="float:right"><i class="uk-icon-rss uk-icon-tiny"></i></a>
          </li>
          <li >
            <a href="https://computable.ai/category/miscellany.html">Miscellany</a>
            <a rel="alternate" type="application/atom+xml" href="https://computable.ai/feeds/miscellany.atom.xml" class="mg-feed" style="float:right"><i class="uk-icon-rss uk-icon-tiny"></i></a>
          </li>
          <hr />
          <li >
              <a href="https://computable.ai/pages/about.html">About</a>
          </li>

          <!-- <li class="uk-nav-header">Other</li>
          <li><a type="application/atom+xml" href="https://computable.ai/feeds/all.atom.xml">All Feed</a></li>
          <li>
            <a href="https://twitter.com/computableai">Twitter</a>
          </li>
          <li>
            <a href="https://github.com/computableai">Github</a>
          </li>
 -->

          <li class="uk-nav-divider"></li>
          <li><a href="https://computable.ai/">Archives</a></li>

      </ul>
  </div>
</div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/uikit.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/components/search.min.js"></script>
<script src="https://computable.ai/theme/js/tipuesearch_set.js"></script>
<script src="https://computable.ai/theme/js/tipuesearch.js"></script>
<script src="https://computable.ai/theme/js/jquery.sticky-kit.js"></script>
<script src="https://computable.ai/theme/js/plugins.js"></script>
<script src="https://computable.ai/theme/js/main-search.js"></script>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'computableai'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
 var s = document.createElement('script'); s.async = true;
 s.type = 'text/javascript';
 s.src = '//' + disqus_shortname + '.disqus.com/count.js';
 (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
 }());
</script>

<script>
(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
                                                        function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
 e=o.createElement(i);r=o.getElementsByTagName(i)[0];
 e.src='//www.google-analytics.com/analytics.js';
 r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-134681874-1');ga('send','pageview');
</script>

    </body>
</html>